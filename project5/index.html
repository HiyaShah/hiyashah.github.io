<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>project 5 - fun with diffusion models </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2b0fab34-e8ee-808b-b798-c13eb048bd98" class="page serif"><header><div class="page-header-icon undefined"><img class="icon" src="project%205%20-%20fun%20with%20diffusion%20models/aesthetic-minimalist-matcha-eclw6s07o4z01wzr.gif"/></div><h1 class="page-title" dir="auto">project 5 - fun with diffusion models </h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-803f-8e15-c8d2f825c993" class="">by Hiya Shah </p></div><div style="display:contents" dir="auto"><h1 id="2c4fab34-e8ee-80fc-9f14-d0da7026be6d" class=""><mark class="highlight-teal_background">part 5a - the power of diffusion models </mark></h1></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80e6-8e92-c6490f2b7337" class="">In this part, I utilized the DeepFloyd model to play around with diffusion models, implement diffusion sampling loops, and use them for other tasks such as inpainting and creating optical illusions. I learned a lot about how diffusion works behind the scenes, and it was very cool to see the hybrid images produced!</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80f5-bbcc-d161687be99f" class="">
</p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8074-a661-c122c066b754" class=""><mark class="highlight-pink_background"><strong>Part 0 - Setup </strong></mark></p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8042-9482-f58327fd5455" class=""><span style="border-bottom:0.05em solid">Text Prompts &amp; Embeddings</span></p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8038-98b9-c7d803e9369d" class="">Random Seed: 180</p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8091-823b-cbc44a753637" class="">I generated embeddings for the following text prompts:</p></div><div style="display:contents" dir="ltr"><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="2b0fab34-e8ee-80ef-a43a-c0fbcf62cc43"><div style="width:100%"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ad-8708-dbf5ec797c58" class="">an acrylic painting of the Campanile at sunset<br/>a city floating on clouds<br/>a cozy cabin in snowy forest<br/>a cyberpunk street market with neon signs and rain<br/>a tranquil Japanese garden with a koi pond<br/>a steampunk airship over Victorian London<br/>a cozy coffee shop interior with hanging plants<br/>a coral reef teeming with colorful fish<br/>a modern skyscraper skyline at dusk<br/>a misty mountain lake at dawn, low clouds<br/>a sunflower field in summer</p></div></div></figure></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80e7-a56c-c2d1849743ca" class=""><span style="border-bottom:0.05em solid">Generated Sample Images</span></p></div><div style="display:contents" dir="auto"><blockquote id="2c4fab34-e8ee-803c-aeb8-cd85d94bf79b" class=""><strong>Prompt 1</strong>: a cozy cabin in snowy forest</blockquote></div><div style="display:contents" dir="auto"><ol type="1" id="2b0fab34-e8ee-80e4-ada1-d255267113d3" class="numbered-list" start="1"><li><code>num_inference_steps</code> = 20 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-807e-82d3-cf8cc1e300c0" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80e5-98ee-dbeb2176e82f" style="width:18.75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80a0-8e56-f18ac9377220" class=""><em>Stage 1 </em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-800b-8151-f315156bd57f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80de-87d5-ef64c17271a6" style="width:81.25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80b7-8d5c-e3d911144172" class=""><em>Stage 2</em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-803a-acc0-fcbdf539d42a" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%201.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%201.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8005-88e5-fff30951d6bb" class="">
</p></div><div style="display:contents" dir="auto"><ol type="1" id="2b0fab34-e8ee-80e7-b836-fc6df53e74d6" class="numbered-list" start="2"><li><code>num_inference_steps</code> = 60 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-805b-87ba-f755350f434d" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8023-bc69-d8bc1bf79f2d" style="width:18.75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80f4-8e78-ecdb0afcd3f6" class=""><em>Stage 1 </em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-805d-a9a6-deaf7c25e2f5" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%202.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%202.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-804a-a028-f07c0b18cc84" style="width:81.25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8015-8aa6-dbc473fbc1a5" class=""><em>Stage 2</em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a3-b494-cbe13d6dfad0" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%203.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%203.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2b0fab34-e8ee-8032-818a-de5ee6989e34" class="numbered-list" start="3"><li><code>num_inference_steps</code> = 100 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8005-904f-d55e6173b063" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8019-bde0-eea91c5ecaeb" style="width:18.75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80e5-8ad6-ffcdcdbfdfd3" class=""><em>Stage 1 </em></p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8020-806a-ed14e7d68728" style="width:81.25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8057-9cdf-df057ec82250" class=""><em>Stage 2</em></p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c2-99f5-cd9b6b44a6f7" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-809b-a9e0-e6e484b99b5d" style="width:18.75%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a0-a92f-db93b51c13bb" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%204.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%204.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8000-bd28-da5c81aea996" style="width:81.25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8047-a835-eb5ae3bfbe4c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%205.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%205.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><blockquote id="2c4fab34-e8ee-8055-8527-ed2c1ed542de" class=""><strong>Prompt 2</strong>: a cyberpunk street market with neon signs and rain</blockquote></div><div style="display:contents" dir="auto"><ol type="1" id="2c4fab34-e8ee-8009-b450-e8f2412c3954" class="numbered-list" start="1"><li><code>num_inference_steps</code> = 20 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8045-8337-c5528a539fc4" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8056-a4a2-ff936f364a55" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8047-bb23-ecb2e207ec87" class=""><em>Stage 1 </em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80d4-8999-fa02edcbb127" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%206.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%206.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8059-bff8-fdcac1ae48ad" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80b9-a21a-dd95edc6ddb3" style="width:75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8033-ae84-fc154b210c57" class=""><em>Stage 2</em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a6-b15b-c231f127efcd" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%207.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%207.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2c4fab34-e8ee-80ca-8d27-c304c9bff045" class="numbered-list" start="2"><li><code>num_inference_steps</code> = 60 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80de-89a2-eae3814e1551" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8086-8d29-cacf1f07ef18" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80f8-9c09-ee3ea38fdc81" class=""><em>Stage 1 </em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-803e-b0aa-c7250b174954" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%208.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%208.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-805e-8c06-c0262c368e0d" style="width:75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8088-8a80-c83f472bc6b7" class=""><em>Stage 2</em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a6-8981-c5a0fec4dd53" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%209.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%209.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2c4fab34-e8ee-8078-bbb4-d256a5da88c1" class="numbered-list" start="3"><li><code>num_inference_steps</code> = 100 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-804a-ad86-e8dae38096b2" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-806d-9d04-cecdd337416a" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80c1-a1c0-dd810f12e96f" class=""><em>Stage 1 </em></p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-809a-b7ba-c3573c39123f" style="width:75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80d0-bc98-ff2040636316" class=""><em>Stage 2</em></p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80bf-9c51-e34912ac5c50" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-804f-8d84-e2e6563f249e" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8034-9056-ddaf86c62951" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2010.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2010.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8001-89bb-f7e4f8ff915d" style="width:75%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80c9-9431-ca82825009b7" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2011.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2011.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><blockquote id="2c4fab34-e8ee-80ef-a921-cd184b17cee9" class=""><strong>Prompt 3: </strong>a tranquil Japanese garden with a koi pond</blockquote></div><div style="display:contents" dir="auto"><ol type="1" id="2c4fab34-e8ee-80dc-9a47-c937ce0363d2" class="numbered-list" start="1"><li><code>num_inference_steps</code> = 20 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-806d-b569-fbc86f4b5b21" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-801f-890b-db7a4f7ee878" style="width:18.75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80bc-8b1d-f3ad42f4f9b4" class=""><em>Stage 1 </em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-800f-b982-ea91f3f6858d" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2012.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2012.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80d7-a188-cdbc34b6847e" style="width:81.25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8017-83a6-da3deeb5ecfb" class=""><em>Stage 2</em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80d4-ac41-d97c718b148b" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2013.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2013.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2c4fab34-e8ee-8060-af08-f212f44a0234" class="numbered-list" start="2"><li><code>num_inference_steps</code> = 60 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-809a-9a0a-f71c7d750eb9" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8089-8bcf-dafa0397b759" style="width:18.75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80d6-9c9f-c9c7604c1f15" class=""><em>Stage 1 </em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80c2-a08e-c8055dc1b12e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2014.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2014.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-806f-950b-ddfc677c59fc" style="width:81.25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80b2-873e-dfdcc0ab4542" class=""><em>Stage 2</em></p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80d5-8aff-fa781b36367a" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2015.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2015.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2c4fab34-e8ee-80cd-9f65-d40fc3c09976" class="numbered-list" start="3"><li><code>num_inference_steps</code> = 100 </li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-802a-bab6-ea1096ca6958" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8050-a474-c5644119a2b6" style="width:18.75%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8042-bb8c-fc7b8591f94d" class=""><em>Stage 1</em></p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8016-b628-e26299038b89" style="width:81.25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80ba-9580-f9a05f56a571" class=""><em>Stage 2</em></p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80f6-8068-c8269c73cf93" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-805a-8c97-f56e0e2818a5" style="width:18.75%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8081-8335-e51f2657b46e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2016.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2016.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8094-82de-cf363ed3d2ce" style="width:81.25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80dd-8faf-c38f99a7ebe0" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2017.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2017.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8009-97c5-f583841206c1" class="">
</p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8055-a9ec-e8954711a0ec" class="">I also reran for both stage 1 and stage 2 outputs at num_inference_steps =20, 40, 60 respectively.</p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80e1-ab06-ce15f5823e1a" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ee-b223-f699e3498bd9" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80ee-b33b-d3096acd8307" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_8.05.39_PM.png"><img style="width:912px" src="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_8.05.39_PM.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80a0-a378-c6c228b179f4" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-809c-bfa4-ead8e6e2501a" class=""><em>My Reflection</em></p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-809a-83c4-eaec1f0e0d3b" style="width:33.33333333333334%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-805d-9dcd-d08638493888" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_8.07.43_PM.png"><img style="width:2470px" src="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_8.07.43_PM.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8030-9602-d6bd879b3362" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8032-84c9-d18e88e08768" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_8.10.45_PM.png"><img style="width:1756px" src="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_8.10.45_PM.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8094-b5be-feddfe12c4da" class="">As I increased the num_inference steps, I saw that the model included more details (ex. more neon signs for the cyberpunk market with neon signs and rain), and the scenes generally looked more realistic. One limitation of my generations is that I mainly prompted settings rather than humans/animals, so the model quality might have differed for these. At num_inference_steps of 20, the roof of the cozy cabin in a snowy forest lacked texture, but as I increased these steps, it gained more texture and visual shadows, overall gaining realism. Generally, I saw that the generated images included all of the elements I requested in the prompt and did not miss anything or hallucinate much (except for the rain), but I also only asked for one-two elements at a time. </p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80ce-bc9f-f80a270475da" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-805d-9bd7-e0fe87c87d9b" class=""><mark class="highlight-pink_background"><strong>Part 1 - Sampling Loops </strong></mark></p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8088-84c8-f6194e013a64" class=""><strong>1.1 Implementing the Forward Process </strong></p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8024-8caf-d7ba4e0c3ce0" class="">To implement the <code>forward(im, t)</code> function, which is the forward diffusion process, I generate a noisy image <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> from a clean image <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> at timestep t according to the diffusion equation here: <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mtext> ⁣</mtext><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">;</mo><mtext> </mtext><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><mtext> </mtext><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mtext>  </mtext><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mi>I</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(x_t \mid x_0) = \mathcal{N}\!\left(x_t;\, \sqrt{\bar{\alpha}_t}\, x_0,\; (1 - \bar{\alpha}_t) I \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0439em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span><span>﻿</span></span> such that <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar{\alpha}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the cumulative product of the noise schedule up to timestep t. Equivalently, a noisy image can be sampled as </p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80dc-9b34-dcbd6efaaa57" class=""><style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><mtext> </mtext><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><mtext> </mtext><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">x_t = \sqrt{\bar{\alpha}_t}\, x_0 + \sqrt{1 - \bar{\alpha}_t}\, \epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2461em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2078em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> where <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\epsilon \sim \mathcal{N}(0, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> .</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80dc-8e42-fdee6f79307d" class="">In my implementation, I retrieve <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar{\alpha}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> from the DDPM scheduler’s <code>alphas_cumprod</code> array and sample Gaussian noise <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> with the same shape as the image. I scaled the clean image and the noise by their respective coefficients above and summed them to produce the noisy image at timestep t. As t increases, <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar{\alpha}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> decreases, which results in progressively noisier images. For t = 0, <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar{\alpha}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is about 1 (nearly clean), while for large t, <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar{\alpha}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is about 0 (approximate pure noise). I also performed these computations under torch.no_grad() since the forward process is just used to generate noisy inputs.</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8056-8715-eccb1f4bef23" class="">The Campanile at the noise levels [250, 500, 750]:</p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80e7-b09e-fb9a2e47ae9e" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8058-8c8f-e9e02e229ef6" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80e5-ab32-f64b29205386" class="">original </p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80f6-92ba-db2c14dec913" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2018.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2018.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80a4-a8ce-f2d3b2a3cec3" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8001-9ca4-c84d7d258d0f" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80c7-a839-cf0877506264" class="">t=250 </p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8013-82e6-e40bb03a19bc" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2019.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2019.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80a7-be8e-f19e92018703" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8049-bf0e-c55d461d17f2" class="">t=500 </p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-805b-b028-f60bdd2aa347" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2020.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2020.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8011-8763-fd6ac94cea68" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8007-a342-c11871851463" class="">t=750</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-806c-96ff-cf7bf090ab1e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2021.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2021.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80c5-9a8a-ddf68eb94172" class=""><strong>1.2 Classical Denoising </strong></p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80b0-86bf-d87c235b58b0" class="">In my first attempt, I attempted to denoise the images using classical Gaussian blur filtering, which provides a baseline for the later approaches I tried. I applied Gaussian blur to the noisy Campanile images at timesteps 250, 500, and 750 to perform classical denoising, which I noticed performed relatively poorly at denoising; it struggled to recover fine details in the original Campanile image.</p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8085-bf4e-d462fb3ee869" class="">Gaussian blur params: <code>kernel_size</code>=7, <code>sigma</code>=1.5</p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8029-97b0-c42e6b2fc655" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80af-8b4c-e5af4ffcf3b4" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80ef-8ef9-c4a9235d7290" class="">Noisy img at t=250 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8069-827d-f2f702f6c737" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2019.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2019.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-800d-9534-e807dd1f96cb" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-803c-910a-cf0b28ff2c87" class="">Noisy img at t=500 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80ce-847d-f622af49add7" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2020.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2020.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8023-b09d-e09fdb6c134e" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80e8-bba4-c27cf65e87bf" class="">Noisy img at t=750</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80c1-b251-ca02308c24fe" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2021.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2021.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80a1-9942-ec86d0e46943" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-802f-af32-fb54d8b31b4f" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8029-90c3-ec2396e4c3e0" class="">Gaussian Blur Denoising at t=250</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80ed-b1f0-f157fc671279" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2022.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2022.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8072-be7f-cf70faad253f" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-804d-8997-f1b81da4593c" class="">Gaussian Blur Denoising at t=500</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80cb-a5d4-d1839965d95c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2023.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2023.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80a3-980c-ef0cd646bb20" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8057-b6d7-e0cc61323af0" class="">Gaussian Blur Denoising at t=750</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8079-802e-e6a44a9ed03a" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2024.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2024.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8010-83af-ee76c0393290" class="">
</p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80b9-b8be-de6e38e1ce71" class=""><strong>1.3 One-Step Denoising </strong></p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80de-8c0c-c597767001d1" class="">In this part, I use the pre-trained DeepFloyd diffusion UNet to perform a single denoising step of mapping a noisy image back toward an approximation of the original image. Given a clean image <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, I first generate a noisy image <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> at timestep t using the forward diffusion process <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_t = \mathrm{forward}(x_0, t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">forward</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. </p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-803c-9701-ccc2a40e35b3" class="">I then apply the UNet to the noisy image to estimate the Gaussian noise added during the forward process by <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>θ</mi></msub><mo>=</mo><mrow><mi mathvariant="normal">U</mi><mi mathvariant="normal">N</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><mtext>prompt</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\epsilon_\theta = \mathrm{UNet}(x_t, t, \text{prompt})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">UNet</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">prompt</span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. </p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-803a-9ca7-f3bb5aa99fc4" class="">Using this noise I predicted, I recover an estimate of the original clean image by rearranging the forward diffusion equation as <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>0</mn></msub><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><mtext> </mtext><msub><mi>ϵ</mi><mi>θ</mi></msub></mrow><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\hat{x}_0 = \frac{x_t - \sqrt{1 - \bar{\alpha}_t}\, \epsilon_\theta}{\sqrt{\bar{\alpha}_t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.576em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.038em;"><span style="top:-2.6279em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.803em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.763em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.237em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4491em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8013em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1987em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span>.</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80a9-991b-cf4f9871a663" class="">I noticed that since the UNet can predict and subtract the specific noise added at a given timestep instead of removing noise by uniformly smoothing local pixel neighborhoods as in classical Gaussian blur denoising, it better preserved the image details</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80e2-8e0b-d0ade22d8f54" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80c1-8f1f-ebeaaa4907aa" class="">Original Campanile</p></div><div style="display:contents" dir="ltr"><figure id="2c5fab34-e8ee-80f0-9e5f-fe973427850f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2025.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2025.png"/></a></figure></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-807d-9a9b-c26f2ec13f15" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80e3-9919-f23c5cfbc5f0" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ac-bf1e-ee8667c24c58" class="">Noisy Campanile t=250 </p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80e8-8d09-d186115cf583" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2026.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2026.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-806c-88f0-c074950cb47b" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ba-b125-f3dce59e71e0" class="">Noisy Campanile t=500</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8074-ad07-ff0b548c4cf7" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2027.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2027.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-805a-8f0c-f2c8d0966240" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-806c-86a3-e4db6c87e375" class="">Noisy Campanile t=750</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80c2-9fca-f8252d370e5a" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2028.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2028.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8053-845f-f1116fe63df3" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8046-b3cd-fe3809dbc7c7" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8040-a366-d6c23dc8c946" class="">One-Step Denoised t=250</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8066-a028-d9688c73f850" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2029.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2029.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80b9-ae06-ed2675b965c4" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80f5-b529-e72e64409d6b" class="">One-Step Denoised t=500</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80ca-a5d7-e15b23a494f6" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2030.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2030.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80aa-be6e-eb7fe1913ca5" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ad-8217-ec08ba6f8de5" class="">One-Step Denoised t=750</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8070-9b29-e178d271e133" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2031.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2031.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8093-8819-d69b4d46c2e0" class=""><strong>1.4 Iterative Denoising </strong></p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80aa-95ea-fda0fb5d89fa" class="">Instead of removing all the noise in a single step, I now denoised images iteratively. Starting from a noisy image <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>,</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80ad-b852-e46e73f45c5d" class="">the UNet model progressively removes noise over multiple timesteps, which I noticed resulted in significantly better reconstruction results than one-step denoising. At each iteration, I computed a less noisy image using this update rule:</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8045-a1ca-c0e9e3b4f6e5" class=""><style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo>=</mo><mfrac><mrow><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></msqrt><mtext> </mtext><msub><mi>β</mi><mi>t</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><mtext> </mtext><msub><mi>x</mi><mn>0</mn></msub><mtext>  </mtext><mo>+</mo><mtext>  </mtext><mfrac><mrow><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><mtext> </mtext><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><mtext> </mtext><msub><mi>x</mi><mi>t</mi></msub><mtext>  </mtext><mo>+</mo><mtext>  </mtext><msub><mi>v</mi><mi>σ</mi></msub></mrow><annotation encoding="application/x-tex">x_{t&#x27;} =\frac{\sqrt{\bar{\alpha}_{t&#x27;}}\, \beta_t}{1 - \bar{\alpha}_t}\, x_0\;+\;\frac{\sqrt{\alpha_t}\, (1 - \bar{\alpha}_{t&#x27;})}{1 - \bar{\alpha}_t}\, x_t\;+\;v_\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4831em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.038em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5175em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7435em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.6068em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8496em;"><span style="top:-2.8496em;margin-right:0.1em;"><span class="pstrut" style="height:2.5556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.262em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7035em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2965em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0528em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.494em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0489em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5239em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7344em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3056em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.6068em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8496em;"><span style="top:-2.8496em;margin-right:0.1em;"><span class="pstrut" style="height:2.5556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.262em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8094-9315-e103928a3d64" class="">where <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the current noisy image, <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the estimated clean image obtained from one-step denoising, <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>t</mi></msub><mo>=</mo><mfrac><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></mfrac></mrow><annotation encoding="application/x-tex">\alpha_t = \frac{\bar{\alpha}_t}{\bar{\alpha}_{t&#x27;}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.336em;vertical-align:-0.5284em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8075em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.6068em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8496em;"><span style="top:-2.8496em;margin-right:0.1em;"><span class="pstrut" style="height:2.5556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.262em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5284em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span>, <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>t</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\beta_t = 1 - \alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, and <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>σ</mi></msub></mrow><annotation encoding="application/x-tex">v_\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is sampled Gaussian noise. </p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80a4-b2c2-c5d18bfd01d8" class="">Instead of performing all 1000 denoising steps, I used strided timesteps so I could reduce the computation. Starting from t = 990, I iteratively denoised using a stride of 30 until reaching t=0, which corresponds to the timesteps [990, 960, 930, …, 30, 0]. Also, I started at index i_start = 10, corresponding to t=690.</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8057-901d-cfea8a989c0b" class=""><span style="border-bottom:0.05em solid">Iterative Denoising Progression</span></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80c4-aace-c20c110f6b61" class="">
</p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8070-acac-dbf351b2729a" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8004-9590-ebc6704ab8fb" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80b5-ad65-e1b76d1a15b5" class="">Noisy Campanile at t=90</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8031-8840-eb7175742aa1" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-809f-9bcd-d8ea4a130792" class="">Noisy Campanile at t=240</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80e0-bdb5-c2c04405e351" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8079-b76a-dbaeed32a474" class="">Noisy Campanile at t=390</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80da-aa64-c7e0cf814a15" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8063-a5fd-c1d5ca0c4f4f" class="">Noisy Campanile at t=540</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8031-987b-f9aaf26474d5" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-802d-a29a-d1a06cceb99a" class="">Noisy Campanile at t=690</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80fc-b788-c1faf42285a5" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80c5-87f7-ca2b3956ed2b" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80db-a88a-e8809610221a" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2032.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2032.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-807f-9162-f070afee2b5f" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8064-b84b-c8e287a70a49" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2033.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2033.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8097-ad6c-d9ff00263295" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8085-b004-e6126ff2693b" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2034.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2034.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80a1-82b3-da583f4ef0d8" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8046-a00a-e92a0fabde86" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2035.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2035.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-805b-bde9-c44774364f5f" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80ad-a59d-c717d7b85e1e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2036.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2036.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8023-80cc-c312feefe666" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8047-b527-d11b2a3b0732" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8077-9f49-fcfe20904d1e" class="">Original </p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8040-9716-ecef30f5dbfc" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80eb-a23a-d9692e285e62" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80d9-8954-e34737d7bdaa" class="">Iteratively Denoised Campanile</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-806d-a2c1-d65d6de03106" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80c9-8dcf-df9e14e8155f" class="">One-Step Denoised Campanile  </p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ad-9012-ffb7fc9efc60" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80cc-b730-e437eccbdd34" class="">Gaussian Blurred Campanile </p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80b6-af58-e2a62631b957" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8032-8be2-fdd30c415dd0" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8072-b0ef-de62996038d2" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2037.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2037.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8044-b057-dac59d859f0c" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-809f-a73f-ed253df7217c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2038.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2038.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8022-8709-ffdfa9aff06a" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80a1-add1-e47ab2d25d58" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2039.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2039.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-804a-b400-d6368fc9c36c" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8029-be7e-ead766374f70" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2040.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2040.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80c7-8b74-c37c95eb11e9" class="">
</p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80f0-9c86-eae024e7e0e1" class=""><strong>1.5 Diffusion Model Sampling </strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8009-aed1-c32c358c1f8b" class="">I used iterative denoising starting from pure Gaussian noise to generate new images from scratch without initial input (I used prompt “a high quality photo”). </p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8019-a352-ed4ab5a53502" class="">I initialized with pure Gaussian noise <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>T</mi></msub><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_T \sim \mathcal{N}(0, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> and set i_start = 0, corresponding to starting from timestep t = 990. I then applied iterative denoising update over strided timesteps, gradually removing noise until reaching t = 0. The final output <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is a newly generated image sampled from the model’s learned distribution and conditioned on the text prompt “a high quality photo.”</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80d9-8f19-faad81dd3ebb" class="">I noticed that the generated images lacked semantic meaning and I could not recognize the components in some of them, but they were of reasonably high quality.</p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8034-9117-df21e09d929d" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ff-a7f6-f106ef7c25ec" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ef-9ccc-c55e0166c636" class="">Sample 1</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ea-a8cd-f71d68a13c20" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8059-ac5e-deee85697d79" class="">Sample 2</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8061-b212-d14ea2ce2627" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80dd-8c6e-e19237b8d79a" class="">Sample 3</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8004-812f-febbc49d1c52" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8064-9203-c2b3d7699e88" class="">Sample 4</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-801b-a415-e0fbe7a95a60" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80e1-8139-ce48b8574b50" class="">Sample 5</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8099-bf19-f69695bff22b" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8087-a963-e76259439f96" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8090-943a-f6b0be7541c1" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2041.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2041.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80c6-8b97-c32cc6ab1523" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8052-85a3-ce8cd087f911" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2042.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2042.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80b8-9733-ec14a8d10ea8" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-804f-8b1f-c18194521a6e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2043.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2043.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80d4-bcda-e7037dc57c6a" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80e0-92bc-d3590986670e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2044.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2044.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-807e-a723-d991e4b3f10d" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80ea-8c57-d6ff8643a472" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2045.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2045.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80e1-b73a-dc2401f5e2cc" class=""><strong>1.6 Classifier-Free Guidance (CFG)</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80a6-9867-c17810598707" class="">I implemented classifier-free guidance using the formula below with the guidance scale that controls the strength of the conditioning towards the text prompt, <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">\gamma = 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span></span><span>﻿</span></span>,and  where <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_u </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is unconditional noise estimate, and <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is conditional noise estimate. I found that it improved the quality of the generation, and that the images were generally more coherent and less diverse.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80e5-8025-e012345abd8f" class=""><style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><msub><mi>ϵ</mi><mi>u</mi></msub><mo>+</mo><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mi>c</mi></msub><mo>−</mo><msub><mi>ϵ</mi><mi>u</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\epsilon = \epsilon_u + \gamma(\epsilon_c - \epsilon_u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>.</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8086-9f26-d0a1f0038708" class="">Specifically, classifier-free guidance combines conditional and unconditional noise estimates and extrapolates in the direction of the conditioning signal. At each denoising step, the UNet is evaluated twice: once with the text prompt to produce a conditional noise estimate and once with an empty prompt to produce an unconditional estimate. The final guided noise estimate <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> was used in the iterative denoising update from 1.4 to generate images that more closely align with the provided text prompt, still “a high quality photo.”</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-801a-a583-f4dc972f87f4" class=""><span style="border-bottom:0.05em solid">Generated Samples with CFG</span></p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8056-b0b8-df636bfc919a" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8046-ba25-eb5165638b05" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80d5-b0cb-c267b6b474cf" class="">Sample 1 </p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8020-aef0-c830c8b3df2f" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8079-800a-f8a1c2bdbfd9" class="">Sample 2</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-800c-b1cb-d8faf4331e2c" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80c9-bd3d-cccf1b20d247" class="">Sample 3</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8022-86e4-e4f900d06982" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8062-8a4d-f593015f5184" class="">Sample 4</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80c4-8e9f-c489a68ffd3e" style="width:20%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8026-8eb2-eebd4fb8f04d" class="">Sample 5</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8043-b528-cf0ee0b91249" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8041-ab4f-e753af3aa08b" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8043-9fb0-cb8adfd44af8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2046.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2046.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-803c-b50b-c7e6346e47fa" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-801a-a05d-c470fcc0df19" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2047.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2047.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8020-8b06-c20e8f097535" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80bb-916e-d962523fdd49" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2048.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2048.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-802f-8116-fa63feb15390" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80e1-a9b1-d74c19e9aac8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2049.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2049.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8073-bb98-e751ce237627" style="width:20%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8092-ad68-ccc0f1916af8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2050.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2050.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-806c-b14f-c4308d018864" class=""><strong>1.7 Image to Image Translation </strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-800e-84a1-f88252448f2e" class="">I utilized SDEdit to add a small amount of noise to the original images and then iteratively denoising it without conditioning, forcing it back onto the natural image manifold so that the output remains similar to the original while gradually refining as the noise level decreases.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80d3-a6d7-e5b5d60b7844" class=""><mark class="highlight-red_background">Campanile:</mark></p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-803b-8230-cf6c372fe1e6" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80d7-ab50-ef08579b6ebd" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80b8-a64f-cec22cf2f61e" class="">SDEdit with i_start=1</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-800c-baf5-fda37c062264" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80e9-a594-c7c4396bc4ad" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-800c-9c12-d50756180b16" class="">SDEdit with i_start=3</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-802a-bed6-f9accd277d8e" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-802b-953e-c15b03ad031b" class="">SDEdit with i_start=5</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80b1-aefa-fc5aa43c95b0" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8085-9744-f1a96a32d67f" class="">SDEdit with i_start=7</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-805c-98a4-ec5ca5d782d9" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8034-9dc4-fb0110ba0c8e" class="">SDEdit with i_start=10</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8004-920c-c47ee2418140" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ab-906a-ffab81d7cda2" class="">SDEdit with i_start=20</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-802f-ab07-de8f48c81099" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80a4-b2e8-e7de65914bd1" class="">Original Campanile</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8062-96b0-f9923fd8e6e4" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8046-8fed-e2769fc5978b" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8098-8087-f10c39f7ed4f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2051.png"><img style="width:108px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2051.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8004-966b-c8441aab8c85" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80a7-a50f-f77b77f37021" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2052.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2052.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8021-8de2-d139133a02ce" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80c4-aa78-fb73a80b4aad" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2053.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2053.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80cd-b987-da95d92be23b" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80df-9c7d-d26520f0b735" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2054.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2054.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ba-b41c-d506fae20064" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-808d-83b4-c19ea3c24c3f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2055.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2055.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ee-b151-efc73fb1c257" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-800e-b7d9-cd76b0dd5b3f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2056.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2056.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80b5-9359-c462ad8230b8" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80a8-87eb-f6d2acd26662" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2057.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2057.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-806a-b563-e2b3842db527" class=""><mark class="highlight-red_background">Test Image 1 (Frog Bank):</mark></p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8049-ad1e-efc18eb05111" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8011-abe8-cfcf9f12c727" style="width:16.07142857142857%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80cb-b496-c111fd26e8f1" class="">SDEdit with i_start=1</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8044-a6d6-f3d54c6c8f76" style="width:12.500000000000005%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ab-b23f-e3197b8295d0" class="">SDEdit with i_start=3</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80b8-974e-e56fe62c3b95" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8070-867f-f7f14ffd2879" class="">SDEdit with i_start=5</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8075-91b7-f920d818d529" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8003-8602-f9f31d4dbc49" class="">SDEdit with i_start=7</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-808f-b8aa-fc1378ca0035" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-800d-ac17-f8f18ad03464" class="">SDEdit with i_start=10</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ce-a187-fd630c015a9b" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-802b-a329-c698af2a050c" class="">SDEdit with i_start=20</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-800d-9766-e326c7b21fe6" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-803e-abce-f3972e0dea48" class="">Original Frog Bank </p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ee-a7ee-dbd56957e2b8" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8025-bcc8-e98446812ac8" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8002-a5f0-db6c8ee76a07" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2058.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2058.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8084-9c6d-ee9a7d33be0e" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8062-92b7-ee1179cb5a02" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2059.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2059.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80cd-abc2-e393f25a01c9" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80c7-b2c4-ea71368300d6" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2060.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2060.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80a2-b0f0-d78523d666ed" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-808b-8117-dd7a0f0940cc" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2061.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2061.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8033-b980-eeebe00e114e" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8081-9441-e0214c2fadbd" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2062.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2062.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80db-8626-f3e954033a1b" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80d0-9b2f-d1169fbdd2d0" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2063.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2063.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80eb-b5e7-c0ee65327345" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8071-a549-dcee367ed521" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2064.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2064.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80a7-accb-e4f81f8d9124" class=""><mark class="highlight-red_background">Test Image 2 (Chichen Itza):</mark></p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-802d-92ec-fcade843678d" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80d0-b9b8-eb05fe0904de" style="width:16.07142857142857%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8095-96fd-e75984076dbe" class="">SDEdit with i_start=1</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-806c-9985-e6b237005806" style="width:12.500000000000005%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ea-ad22-e3c0b22a594a" class="">SDEdit with i_start=3</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ee-9349-f92fbafe7822" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-808d-9fee-d5e6b7c886c1" class="">SDEdit with i_start=5</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-804f-b824-ef890a542375" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80af-81e4-d18bacb44c15" class="">SDEdit with i_start=7</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-805f-96d9-cbfc5509f495" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8003-8762-d2db83c14ffd" class="">SDEdit with i_start=10</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8074-ad4c-f2ec2d9ada2d" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80f5-93bb-c8f74d684dab" class="">SDEdit with i_start=20</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80a6-95b3-c7a56e311a0e" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-807c-95c2-c8f0ce48c0d4" class="">Original Chichen Itza</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80d1-9489-d595a464c2b4" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80ce-882b-e49b06f42647" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-802b-bc92-e25301cbc314" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2065.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2065.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80d0-b991-eacf1846ac91" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8065-b55c-caf05a00e80c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2066.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2066.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80dd-a66c-dd2a1d881b89" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8073-83fa-c30df7fd904c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2067.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2067.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8064-989d-cb30d4b041cb" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80ea-bd8d-e2c0cc3f1cdc" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2068.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2068.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8054-837d-cc600919181d" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80a2-a914-ee2949be5f98" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2069.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2069.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80b2-93de-d91cc90625f6" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8040-88b5-e008eaaf0e96" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2070.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2070.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-801a-8898-f4143656e226" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80a9-8833-cedb74c26b64" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2071.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2071.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8074-883a-ccc48e7a60fe" class=""><mark class="highlight-red_background">Test Image 3 (Red Velvet Latte):</mark></p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-808d-8897-e6789242fe1c" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8077-9d16-c674c0ff1887" style="width:16.07142857142857%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8043-95f4-f552c518c02e" class="">SDEdit with i_start=1</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8085-b36d-d39fda3dc631" style="width:12.500000000000005%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8099-b92f-c7b77d7cdf56" class="">SDEdit with i_start=3</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80c9-b38d-d2157d18f08d" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-807e-af59-f3a2cc436af1" class="">SDEdit with i_start=5</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8021-b24d-cd3943bafd4a" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80e5-a2f1-cf42c4ce9c83" class="">SDEdit with i_start=7</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80c1-9677-d30bf79040fb" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8057-8b32-cdf91fcf56e9" class="">SDEdit with i_start=10</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80e4-a08b-c5923b0db501" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80b5-9d1d-c5cf26f1ba08" class="">SDEdit with i_start=20</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80a9-add7-e08d11f1f6cc" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8053-8c70-ec676eb4a009" class="">Original Chichen Itza</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8083-a16f-d352b1054b29" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80dd-a2a1-e365c7056c56" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-802c-a741-c44b99376782" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2072.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2072.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80c5-b98b-e27a5ec43520" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80d0-8929-cd2aba253303" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2073.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2073.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8009-a6e1-f2661ae57b8b" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80dc-a089-edaf301295da" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2074.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2074.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8024-8638-fe8a9da63ecf" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-809e-a9af-d010a5d2affe" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2075.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2075.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8023-8296-f8dadd474c5b" style="width:14.285714285714288%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8042-a33b-f048575c7007" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2076.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2076.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8049-abd5-d86b88369fd1" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8052-82fb-d05056c5eb0e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2077.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2077.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8028-97e2-daa3eeda9652" style="width:14.285714285714285%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8029-ac22-d18eb8b107cd" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2078.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2078.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-801e-8326-e35c6cd7d917" class=""><strong>1.7.1 Editing Hand-Drawn and Web Images</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-806c-9f94-d9ae8dd31f5d" class=""><mark class="highlight-red_background">Web Image</mark>: Green Angry Bird </p></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80ef-9b4c-cf8fe89520b0" class="">(the titles are i_start)</p></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-806a-8bea-ea477f67e049" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8090-b225-cc9a75bd785c" style="width:87.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80fb-923f-c190553a558c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/57d1fd33-f132-46de-96d9-d3720b57fd21.png"><img style="width:576px" src="project%205%20-%20fun%20with%20diffusion%20models/57d1fd33-f132-46de-96d9-d3720b57fd21.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-802f-b8ef-f668f29cf2f3" style="width:12.500000000000004%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-809d-86d8-ec6a09c129ea" class="">Original Image</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8082-92dc-cd7768e6653e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/e80f958d-acca-47a9-87d9-6a566cab559e.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/e80f958d-acca-47a9-87d9-6a566cab559e.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8073-b835-ef89160d07de" class=""><mark class="highlight-red_background">Hand Drawn Images</mark></p></div><div style="display:contents" dir="auto"><ol type="1" id="2c5fab34-e8ee-80bb-b90f-e98982d6be40" class="numbered-list" start="1"><li>Tiger</li></ol></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80bf-ab9a-c751cacd39ed" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8078-b7aa-d8b6467031d0" style="width:81.25%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-800c-8f31-e1a074f068ac" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/43b82d30-46ee-4291-a385-936739796963.png"><img style="width:816px" src="project%205%20-%20fun%20with%20diffusion%20models/43b82d30-46ee-4291-a385-936739796963.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8090-81a7-dd4617293476" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8047-b3e6-e2f97a06056f" style="width:18.750000000000004%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80aa-ad03-f875a053c9ae" class="">Original (Processed) Drawing</p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8050-8b7a-cc93f2b665f9" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2079.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2079.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2b0fab34-e8ee-8025-8a51-f821fc016881" class="numbered-list" start="2"><li>Tree </li></ol></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8000-87c5-d96eadecd503" class="column-list"><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-80d7-a861-dc67885904b3" style="width:66.66666666666666%" class="column"><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-80b1-bf8b-db6834d352e2" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_11.26.55_PM.png"><img style="width:1023.9609375px" src="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_11.26.55_PM.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8031-804b-f09679e88d55" style="width:12.500000000000005%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-801c-bdd2-cff99f7ea7b1" class="">Original Drawing </p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8082-8386-f84f4ffbc010" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_11.25.26_PM.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-11-18_at_11.25.26_PM.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2b0fab34-e8ee-8093-825b-ea9b4569e892" style="width:20.833333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-8040-b821-d1b3346cea14" class="">Original Processed Image </p></div><div style="display:contents" dir="ltr"><figure id="2b0fab34-e8ee-8072-92d4-ff646b004923" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2080.png"><img style="width:120px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2080.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2b0fab34-e8ee-80a0-8534-c73ad7d2405f" class=""><strong>1.7.2 In-painting </strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80c0-8254-f575de3715f1" class="">I utilized the algorithm from the RePaint paper to implement inpainting by replacing the unmasked regions of each denoising step with the noised version of the original image, so that the model only synthesizes new content inside the mask.</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8054-bcfc-c30dcbe7b31d" class="">At each denoising step, I obtain <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></mrow><annotation encoding="application/x-tex">x_{t&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and replace the unmasked regions by:</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8030-a909-e0243e82449e" class=""><style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo>←</mo><mi>m</mi><mo>⋅</mo><msub><mi>x</mi><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>m</mi><mo stretchy="false">)</mo><mo>⋅</mo><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">w</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mtext>orig</mtext></msub><mo separator="true">,</mo><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_{t&#x27;} \leftarrow m \cdot x_{t&#x27;} + (1 - m) \cdot \mathrm{forward}(x_{\text{orig}}, t&#x27;)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.038em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathrm">forward</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">orig</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80d5-8e00-fc06ea6616e1" class="">Specifically, it fills masked regions of an image while preserving unmasked content by constraining the diffusion process, where the unmasked regions are replaced using the above equation where m is a binary mask and the forward function adds the appropriate amount of noise to the original image at timestep t’. I noticed that the unmasked regions always match the original, and it was very cool to see the model generate content in masked areas</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8080-9c5f-da98995e6b41" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8024-9c8f-c68b5cce37fc" class=""><mark class="highlight-red_background">Campanile</mark></p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8094-baec-ff5a2fa30dd4" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-804b-ad80-d94943848617" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80a8-9e41-e8033c6d91e0" class="">Original </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a3-9d43-c6222b704972" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2081.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2081.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8088-9f0a-e329e1032531" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80a9-8fee-d3f60e64bc84" class="">Mask</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-808f-a2b2-d60a645e8672" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2082.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2082.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80be-adb1-e6e4d215ee15" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8073-abef-f9ed85960b52" class="">Replacing </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8089-ba86-d41d54257aa7" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2083.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2083.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-802b-a08a-c1f7a6f84bfa" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8025-ae5c-ebf198c17b01" class="">Inpainted</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80de-8dfb-d429521f6414" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2084.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2084.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8018-85dc-e5f7c583b1a0" class=""><mark class="highlight-red_background">Frog</mark> </p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8079-8bb8-fe90d38fe2c3" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8049-bdf2-cdd0754cb639" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-807a-8176-e2d94c5a44f3" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2085.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2085.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8045-bfbd-caadde73fc2b" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8017-a02b-f4733763830f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2086.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2086.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8038-8081-f81d04ff3315" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-805e-bba0-ee2d5ccc71b8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2087.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2087.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8088-966b-e55f4c276cc0" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-806d-b661-db1b957f52ed" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2088.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2088.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-808b-a75f-deed84a1b7e5" class=""><mark class="highlight-red_background">Red Velvet Latte </mark></p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80cc-bd9e-fb3e0e61e928" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8056-9c15-ded2a4a81bbe" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8056-87f8-e6d0ddfb83fd" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2089.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2089.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8027-819a-cc3b3005495f" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80dc-b936-ec5796496b4d" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2090.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2090.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8061-8554-c498264534fc" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-804e-a4ad-d9c6f72cc1c4" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2091.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2091.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80bd-829b-c5eabd5f22bf" style="width:25%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80f9-8fe5-eff14a378a10" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2092.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2092.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8036-a01d-c2f1c634974d" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-806e-af8c-ee6ea6fea063" class=""><strong>1.7.3 Text-Conditional Image-to-image Translation</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80d0-9aae-f631b6ef2e2d" class="">I guided the projection with the following text prompts, changing them from just “a high quality photo” to my prompts below. As this is not a pure projection to the natural image manifold, it adds some control using language. </p></div><div style="display:contents" dir="auto"><blockquote id="2c4fab34-e8ee-80d4-a6b9-fd967a7954c8" class="">Prompt 1 = “a cozy coffee shop interior with hanging plants”</blockquote></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8097-82e0-c1ab86f9e060" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8077-98a7-cbd9b130e882" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80d6-9fc2-e754f0a6f9f6" class="">i_start=1 </p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80d6-83d2-e72d4302e7ff" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80ed-b99b-de52e940bd50" class="">i_start = 3 </p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8069-a106-ce30b99eeef5" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8048-8844-c232620b083c" class="">i_start = 5 </p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8024-bda2-f25e0e6292ad" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-800d-b90d-e0e7cb435426" class="">i_start = 7</p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c4-a8b4-d0bea935971e" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-804f-bfc9-ef432fca13ce" class="">i_start = 10 </p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80f6-9abb-e637025116e5" style="width:16.666666666666664%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8083-9c80-e5dc91ac3587" class="">i_start = 20 </p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-809a-9ac1-f099ab7c4292" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8053-9c58-f1817398b33f" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8050-b5ce-f61bbb36b602" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2093.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2093.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80f5-b414-ff16281cee78" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-804b-992e-e22944f602f1" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2094.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2094.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8037-bd8f-cef4127a9b34" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8064-a666-e302c69ae37b" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2095.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2095.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-806f-9755-e2d5f62d5122" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8045-ab80-ce6ee820e295" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2096.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2096.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8065-97e5-c8bf965c2f24" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8063-aebf-d1d335c82092" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2097.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2097.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80b5-b0e6-d43c907019d2" style="width:16.666666666666664%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80cd-b646-f8a8e063c8f1" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2098.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2098.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><blockquote id="2c4fab34-e8ee-807e-a6a3-eec6c223d8a7" class="">Prompt 2 = “a tranquil Japanese garden with a koi pond”</blockquote></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c8-bfcc-c7ee19401a7d" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80d8-b7af-f8f33198e4bf" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-806b-a3ee-e50b5ed30f4f" class="">i_start=1 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-801b-b852-c6e1fa7ad4a1" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2099.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2099.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80ed-b5fc-f8c65075c7c6" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-808b-ae37-d157833d5661" class="">i_start=3</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a6-a524-c8fb80b325a8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20100.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20100.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-809b-a7d5-eded1a840d85" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80ec-9b6c-eef01635195e" class="">i_start=5 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-802c-9ec2-d0da286f0109" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20101.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20101.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8045-b352-d89308ec1123" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-802f-a02e-f90644d7538b" class="">i_start = 7</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80d1-a344-f25ee4b53bd3" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20102.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20102.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80a4-ac21-f5bdf245b376" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8049-9878-c1c12323c92e" class="">i_start = 10</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80c8-bd8b-e4519da28deb" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20103.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20103.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c1-8df0-d55c2d04d50b" style="width:16.666666666666664%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80ca-b550-dd6445a92d90" class="">i_start = 20 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80d9-9e69-ee0e1501b0d1" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20104.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20104.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><blockquote id="2c4fab34-e8ee-80c3-afdc-d4fe139a93cf" class="">Prompt 3 = “a city floating on clouds”</blockquote></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80fb-8208-eca45be5554a" class="">Original </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-807e-b34c-c0f304624e9b" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20105.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20105.png"/></a></figure></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8027-a04d-deb6ae90cfd6" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8029-85fe-c49006ab5a90" style="width:16.666666666666664%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8025-b6b4-f83696033d53" class="">i_start = 1</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8040-b0f3-d43d9b21e02d" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20106.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20106.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8056-b62c-e0aef3da26f5" style="width:16.66666666666667%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8080-8e41-f9d02882286c" class="">i_start =3 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8068-8d19-c38ab62f0649" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20107.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20107.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8005-8c68-e76f5a120cb5" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-804e-9b8e-dcfb2bb1740a" class="">i_start = 5</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-802f-8b5f-de756395c7d4" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20108.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20108.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c0-911f-fd8feeaa2f98" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8030-846b-ebb3b7f240ac" class="">i_start = 7 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-808a-b469-fdd8681ad4c1" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20109.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20109.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8022-9322-f343df1f112d" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8094-bd37-d373ca08b8e3" class="">i_start = 10 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8050-a98c-da3e63725759" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20110.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20110.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8088-8326-ec867dda5b47" style="width:16.666666666666664%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8066-b31e-f4bb20130d72" class="">i_start = 20 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8031-abee-d9497fefe9d9" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20111.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20111.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><blockquote id="2c4fab34-e8ee-8088-b4e3-c4c3e2674c86" class="">Prompt 4 = “a coral reef teeming with fish”</blockquote></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8066-8c34-cb190b53d634" class="">Original </p></div><div style="display:contents" dir="ltr"><figure id="2c5fab34-e8ee-80ce-ba61-f6da93f1585a" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%2089.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%2089.png"/></a></figure></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8083-b6d8-dadd30c473ec" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80e6-bde7-dc8df1cb5018" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8067-b92b-f139d51cbbf3" class="">i_start =1 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-805a-a25b-ff821b568807" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20112.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20112.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-800a-a9e9-e3640dcc9ce4" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8051-a6f7-d5951ec59072" class="">i_start =3 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8098-a4f9-d2fd78c95f7e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20113.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20113.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-804b-8963-c9ab2afa7b23" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80d8-af18-ed9b824ba4fb" class="">i_start = 5</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a1-a4ce-c67f80586ab7" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20114.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20114.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80e9-b9c1-e43209881411" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80af-8887-f11d381bafc2" class="">i_start = 7</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8065-bb17-c41c9033bc40" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20115.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20115.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-809a-8115-f62ddfd67e0c" style="width:16.666666666666668%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8041-b64b-ffe1e6b72c49" class="">i_start = 10 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8088-8d24-dce5a174245c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20116.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20116.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8030-85f3-ef2b62398a05" style="width:16.666666666666664%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80d2-9fe5-c22c87deefcc" class="">i_start - 20</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80df-8f1c-de2a7625ff09" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20117.png"><img style="width:144px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20117.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80a8-be9a-f81d2f14ccc8" class=""><strong>1.8 Visual Anagrams</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-808d-9be7-ea9aaea07d79" class="">I generated visual anagrams by denoising the same image twice with prompt 1 and prompt 2 respectively. I then flip the second noise prediction back, average the two noise estimates, and use this combined to perform the reverse diffusion step.</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-805f-8eba-ed9a627e6340" class="">Specifically, I learned that visual anagrams generate images that satisfy two different prompts depending on orientation by combining noise estimates from both of the views during diffusion. At each denoising step, I compute a noise estimate <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> with prompt <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and second estimate <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> by flipping the image, denoising with prompt <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, </p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80f5-ab59-eda1feb31c4b" class="">and flipping the resulting noise estimate back. I obtained the final noise estimate by averaging, and used this for the denoising update.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8061-904f-d28acc3bd67b" class="">I utilized the following algorithm:</p></div><div style="display:contents" dir="ltr"><figure id="2c5fab34-e8ee-800b-bb4c-f0dccc3dd551" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-12-09_at_4.53.28_PM.png"><img style="width:288px" src="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-12-09_at_4.53.28_PM.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80d3-85fd-f716b88b6dd0" class=""><span style="border-bottom:0.05em solid">Visual Anagrams</span></p></div><div style="display:contents" dir="auto"><ol type="1" id="2c5fab34-e8ee-805e-82a3-c08a3f857a95" class="numbered-list" start="1"><li><mark class="highlight-red_background">Cabin/Coral Reef </mark></li></ol></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-809c-8374-e14c5e56c021" class="">prompt 1: a cozy cabin in a snowy forest           prompt 2: coral reef </p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80ea-b0c3-dff6f04269d7" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-801b-af0d-f463da45b5cb" style="width:37.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80ae-baab-ea5cb6282222" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20118.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20118.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80da-a76c-fc21d772c275" style="width:62.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8053-b848-f1f2dd9f067e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20119.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20119.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80df-9668-c81583bbedda" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-807e-8b64-d5f8da0be6b2" style="width:37.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-801f-96bf-d35afed69ec8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20120.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20120.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80b2-8054-c00d6966f4aa" style="width:62.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-803c-b44b-de904e47ad25" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20121.png"><img style="width:132px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20121.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2c4fab34-e8ee-804f-b790-c650f42eb9af" class="numbered-list" start="2"><li><mark class="highlight-red_background">Skyscraper / Sunflower Field </mark></li></ol></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c8-b5a1-d32e94c4517a" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8044-812e-e0ed40b13c22" style="width:37.5%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80f3-8892-ea46714e6bbd" class="">prompt 1: a modern skyscraper skyline at dusk</p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8020-9b8b-f16e48b644fa" style="width:62.5%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80a2-ac62-ea7b086dd5e1" class="">prompt 2: a sunflower field in summer</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8048-9b49-ee65730ae924" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80cd-b8c3-c3b35cfaf27e" style="width:37.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8019-96d2-d8a9edcd98ae" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20122.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20122.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8060-9248-d24e50047fb8" style="width:62.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80b3-9668-c44c524acfa5" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20123.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20123.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8007-9fa8-d5ab43dba8fb" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8073-9c05-f3229fe89611" style="width:37.5%" class="column"><div style="display:contents" dir="auto"><ol type="1" id="2c5fab34-e8ee-80e1-a818-f25e7dc1dd3f" class="numbered-list" start="3"><li><mark class="highlight-red_background">Misty Mountain/Cyberpunk </mark></li></ol></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8025-8fc2-e4d68596eaee" class="">prompt1: a misty mountain lake </p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8084-9248-ede3b1e7b0d3" style="width:62.5%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80c4-8659-f1ec50728e5a" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80dc-9a89-f3ef1b274f7f" class="">prompt 2: a cyberpunk street market with neon signs and rain</p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80db-baa9-da7c237b479f" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80d7-9c44-e5da6684c884" style="width:37.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8023-b5d2-d47a0c9947b8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20124.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20124.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80b1-99dd-e98f422f33f6" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8009-88e3-c99098264024" style="width:62.5%" class="column"><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-804b-84b3-d3b23f0b7e75" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20125.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20125.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-803d-afb5-de617252774b" class=""><strong>1.9 Hybrid Images </strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80c1-a735-ef41ac89c469" class="">I implemented factorized diffusion to create hybrid images by creating a composite noise estimate <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span>, by estimating the noise with two different text prompts, and then combining low frequencies from one noise estimate with high frequencies of the other. I utilized the following algorithm: </p></div><div style="display:contents" dir="ltr"><figure id="2c5fab34-e8ee-80ab-a82c-e21c1be52eb0" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-12-09_at_5.03.00_PM.png"><img style="width:192px" src="project%205%20-%20fun%20with%20diffusion%20models/Screenshot_2025-12-09_at_5.03.00_PM.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8073-bf27-f77bc6ad1802" class="">As we have learned in lecture, LP filter extracts low frequencies that are visible from far and the HP filter extracts high frequencies that are visible from near. </p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8019-a2cd-c9306919ddc6" class="">My parameters were:</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8053-9956-fdeb76dfd493" class=""><code>Gaussian Kernel Size</code>: 33 </p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8056-a89a-c7fb4dea7bf2" class=""><code>Sigma</code>: 2.0</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-808a-a7ee-e1eac73856c6" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8092-a717-dc4a2f28165e" class=""><span style="border-bottom:0.05em solid">Hybrid Images</span></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8086-a6a3-da285c24bbe8" class=""><mark class="highlight-red_background">Hybrid Image 1</mark></p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80d0-9b6b-fc53258e6f0c" class="">prompt1 = &#x27;a modern skyscraper skyline at dusk’</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-809d-8911-fff3df9c2c0e" class="">prompt2 = ‘a steampunk airship over Victorian London’</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8034-bd68-f9f2379d6b91" class="">
</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a4-a997-fb2dbeae0ee9" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20126.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20126.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8009-8225-cc6a3e7c1703" class=""><mark class="highlight-red_background">Hybrid Image 2</mark></p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80fc-ba14-fc6354066659" class="">prompt 1 = &#x27;a cozy cabin in snowy forest’</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80f7-ac2f-f8ca160be26b" class="">prompt 2 = ‘a tranquil Japanese garden with a koi pond’</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8099-a50a-e454f19baeb6" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20127.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20127.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8042-b9e8-c404266114bd" class=""><mark class="highlight-red_background">Hybrid Image 3</mark></p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80a9-a0e2-dda23a2298ca" class="">prompt 1 = ‘a city floating on clouds’</p></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8085-a74f-c126510591ac" class="">prompt 2 = ‘a tranquil Japanese garden with a koi pond’</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-803d-b84f-dc51204805b7" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20128.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20128.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80f7-aea0-e7a51dbad4d6" class="">
</p></div><div style="display:contents" dir="auto"><h1 id="2c3fab34-e8ee-8047-81e3-e8f16e6684ba" class=""><mark class="highlight-teal_background">part 5b - flow matching from scratch </mark></h1></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80f6-bcdc-c40fd8c42f46" class="">In Part 5b, I implemented flow matching on MNIST, starting from simple one-step denoising and progressing to fully time- and class-conditioned UNet. Through this process, I learned how noise injection, UNet arch, and conditioning work together to enable iterative denoising and generation of images. I also learned why techniques like classifier-free guidance and learning-rate scheduling matter, which helped me gain some exciting foundations on diffusion!</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80e6-b7c3-fa44689ca00c" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80f4-b1a9-edf1aaa36ba9" class=""><mark class="highlight-red_background">Part 1 - Training a Single-Step Denoising UNet</mark></p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-806b-a5f3-e1e02a5f4d0f" class=""><strong>1.1 Implementing the UNet</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-804f-9416-f23d2430c078" class="">I first implemented a one-step denoiser UNet that given a noisy image z, the denoiser maps z to a clean image x. I optimized over the following loss: </p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8077-8b4e-f1f1270ef427" class=""><style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>z</mi><mo separator="true">,</mo><mi>x</mi></mrow></msub><mtext> </mtext><mi mathvariant="normal">∥</mi><msub><mi>D</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L = \mathbb{E}_{z, x} \,\| D_{\theta}(z) - x \|^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-809a-b78d-f94da67347a7" class=""><strong>1.2 Using the UNet to Train a Denoiser</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80d2-a1fc-fae1fdb9a5aa" class="">To train the denoiser, I generated training data pairs of noisy and clean MNIST digit image (z,x). Thus, for each training batch, I generate z from x using <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>σ</mi><mi>ϵ</mi><mo separator="true">,</mo><mspace width="2em"/><mtext>where </mtext><mi>ϵ</mi><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z = x + \sigma \epsilon, \qquad \text{where } \epsilon \sim \mathcal{N}(0, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mord mathnormal">ϵ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">where </span></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. </p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-803b-8e54-d054ef792b6d" class="">I visualized the noising process over <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mo stretchy="false">[</mo><mn>0.0</mn><mo separator="true">,</mo><mn>0.2</mn><mo separator="true">,</mo><mn>0.4</mn><mo separator="true">,</mo><mn>0.6</mn><mo separator="true">,</mo><mn>0.8</mn><mo separator="true">,</mo><mn>1.0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\sigma=[0.0, 0.2,0.4,0.6,0.8,1.0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1.0</span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span>. I found that as I increased sigma I saw noisier images and the digit became progressively harder to recognize. </p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-809d-b08f-fbcad3228957" class=""> </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-801d-86a7-eee2274a1570" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20129.png"><img style="width:2736px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20129.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80bc-955e-d28876b8aaeb" class=""><strong>1.2.1 Training Loss Curve </strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8004-a779-d3415a1153c8" class="">I trained the model to perform denoising on the noisy image z by applying <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\sigma = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span></span></span></span></span><span>﻿</span></span> to a clean image x.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8019-b232-e2a921497b36" class="">I utilized batch size 256, 5 epochs of training, hidden dimension D = 128, and the Adam optimizer with learning rate 1e-4 with the MNIST dataset. </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80cb-805f-ee0c94caaa92" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20130.png"><img style="width:528px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20130.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80a9-9478-cfd945282cd4" class=""><span style="border-bottom:0.05em solid">Sample Test Results</span></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8097-b693-e02eb6389531" class="">I was surprised to see that even after 1 epoch, the UNet was able to significantly remove noise (although there was still some extraneous details and blur). After 5 epochs, the denoised images were of higher quality</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-808a-ad43-c7dbcaa0c6f0" class="">For each sample, I show: Clean digit (row 1), Noisy with σ=0.5 (row 2), and Denoised (row 3). </p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8061-a2b7-f043cf1b7f46" class="">Sample results after epoch 1 with σ = 0.5:</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-809d-b37e-c40ee1b86bc2" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20131.png"><img style="width:960px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20131.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8094-80e8-c92274517241" class="">Sample results after epoch 5 with σ = 0.5:</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80b7-b53d-f7415b78e0b5" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20132.png"><img style="width:960px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20132.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80bc-9cfa-ff71363a78e8" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-809a-94b6-df9929e167a1" class=""><strong>1.2.2 Out-of-distribution Testing </strong></p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-809f-b73d-d5b7f9139b38" class="">I tested the denoiser on <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span><span>﻿</span></span> that it was not trained on (not 0.5), varying noise levels from [0.0, 0.2, 0.4, 0.5 (trained on), 0.6, 0.8, 1.0]. The first column (leftmost) is the clean image for reference. I tested on the digits 7, 2, 1, 0.</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8047-aa91-c3db598b2a42" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20133.png"><img style="width:624px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20133.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80d7-83b9-d7b3c6a33bdb" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-809d-8c5a-e083ed99b53c" class=""><strong>1.2.3 Denoising Pure Noise</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-802d-af39-f0643c6591e1" class="">I trained a denoiser on pure Gaussian noise, starting with <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">z= \epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> where <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> ~ N(0,I), and we denoise this to get a clean image back. I repeated the same training process as in 1.2.1, but I inputted pure noise <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> ~ N(0,I) and denoised it for 5 epochs. </p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80b2-af1e-c422664b4be0" class=""><span style="border-bottom:0.05em solid">Pure Noise Train Loss </span></p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80a6-aa84-f50a9bb06a23" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20134.png"><img style="width:576px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20134.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80a7-a892-d4a868e4500b" class=""><span style="border-bottom:0.05em solid">Sample test results</span></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80ac-9056-d55c6990fc8d" class="">The top row is the noisy input for a particular sample, and the bottom row is the denoised output.</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-801b-bbdb-cc191172ba64" class="">After the 1st epoch</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80d0-acaa-ce7c3b91f107" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20135.png"><img style="width:768px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20135.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8064-a1a7-e1403af06b1a" class="">After the 5th epoch</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8021-a4e6-d6e551ee6082" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20136.png"><img style="width:768px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20136.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80ff-b9f0-e1dc0af868f1" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80ab-88d7-c02a80f866bb" class=""><span style="border-bottom:0.05em solid">Observations</span> </p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8033-94bf-f1ac6a5b7484" class="">I noticed that since the denoiser is trained to map pure Gaussian noise to MNIST imgs, the generated outputs after training seemed to look blurry, averaged-shaped digits that resemble some vague, rounded 3, 6, 8-like blob shape, which is the average of many MNIST digits and not any specific class. It seems to collapse towards some smooth, centrally located digit like structures that do not have clear identity to a particular digit class in MNIST. It seems to resemble a cluster average of the dataset, and I believe this is due to the optimization object being MSE loss. For pure noise inputs, all the x from 0 to 9 in the training dataset are equally valid targets, so it seems reasonable that the model learns the outputs that minimizes squared error to all of them, and the minimizer to MSE is the conditional expectation, which is the centroid/average of the training images.</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80e5-92f5-f4d91ce25131" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80fe-9ec4-f93ed08bcc74" class=""><mark class="highlight-red_background">Part 2 - Training a Flow Matching Model</mark></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80a9-a6d7-cf3273d7c40f" class="">In this part, I switched from single-step denoising to iterative denoising. Instead of training a model that tries to clean noise in one jump, I trained a model that learns how to move from pure noise to a clean MNIST digit step by step. I did this by taking a noise sample and a real MNIST image, blending them together into intermediate states, and training a UNet to predict the velocity that takes me from the noise sample to the real MNIST digit.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80a1-8a6c-f61a87ea8263" class=""><strong>2.1 Adding Time Conditioning to UNet</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80be-b179-ca6047f8b035" class="">Please see code implementation. To implement flow matching, I utilized a UNet that takes both the image and a time parameter t from [0,10 as input. I achieved this by injecting the time embedding into the network via FC blocks, each of which processes t through two linear layers.</p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-805b-b58e-c84f5649c6e6" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8031-9da0-ca181ba5b690" class=""><strong>2.2 Training the Time-Conditioned UNet</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8008-b01d-d7f6aefa54cf" class="">I trained a time-conditioned UNet to predict the flow at <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> given a noisy image <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and timestep <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span>, utilized MNIST dataset with batch size 64, hidden dimension D = 64, and followed the provided diagram to normalize t and inject this conditional signal into the UNet architecture. I also used Adam optimizer, initial learning rate 1e-2. Initially, I used exponential learning rate decay scheduler with a gamma of <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>0.1</mn><mrow><mn>1.0</mn><mi mathvariant="normal">/</mi><mtext>num_epochs</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">0.1^{1.0/\text{num\_epochs}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord">0.</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1.0/</span><span class="mord text mtight"><span class="mord mtight">num_epochs</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8074-8cc2-ee789b6493c4" class=""><span style="border-bottom:0.05em solid">Training Loss Curve for the Time-Conditioned UNet</span></p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-803c-a356-ea95aaab313a" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8070-9582-e46007e3b1a4" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8040-a130-e594e151226c" class="">Epoch 1 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80ab-9110-db6272eb0d62" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20137.png"><img style="width:384px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20137.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8041-9906-ddd5fdb9f2dc" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8084-a497-e93c89885755" class="">Epoch 2 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8008-bd49-c3433e6e800e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20138.png"><img style="width:384px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20138.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8024-9546-dfc4186e56ff" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-808c-a380-d0f0bc93c1d2" class="">Epoch 3 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-800e-bb63-e455c6d414e1" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20139.png"><img style="width:432px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20139.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-804c-9244-fc42849cb3cf" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8027-988b-d7cd08b1c70b" class="">Epoch 4</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8012-ba79-e705848889f5" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20140.png"><img style="width:432px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20140.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8016-9e8f-e5c522cc25ad" class="">
</p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80cc-a6e9-d14b033f7b7c" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8089-b578-ee012a6b38dc" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-805f-aab4-f8be396468d6" class="">Epoch 5 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8024-b2b1-d595263ed412" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20141.png"><img style="width:432px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20141.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c6-80ec-f7893664ac7e" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80b0-9170-e0344775f3f5" class="">Epoch 6</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80da-9d0d-e8459454c4c0" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20142.png"><img style="width:432px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20142.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8040-9533-dc218fe408c1" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-804d-8c67-e118b1a62a93" class="">Epoch 7</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8035-af60-d779df088d7e" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20143.png"><img style="width:432px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20143.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80d3-9ea2-f481e37cf8b5" style="width:25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-809d-9d65-d7400af741f0" class="">Epoch 8 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80ca-9e56-d84fa476f6e4" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20144.png"><img style="width:480px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20144.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8068-865a-ca812b265228" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80e1-ae44-ed5d03c9b880" style="width:31.25%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80d4-984c-cbe33f310291" class="">Epoch 9</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8036-92d5-ee2fd13ac323" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20145.png"><img style="width:240px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20145.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80d6-9ccd-c17acdaa6d27" style="width:68.75%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80ef-ad72-ec6d80f6a67c" class="">Epoch 10 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8025-ab84-f8014f932f8f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20146.png"><img style="width:384px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20146.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-805a-b5b4-e0fefa370ab0" class=""><strong>2.3 Sampling from the Time-Conditioned UNet</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-804f-9265-c71c8fb2496c" class="">Using iterative denoising, I used Algorithm B.2, which begins from pure gaussian noise and denoises step by step to generate MNIST digits. </p></div><div style="display:contents" dir="ltr"><figure id="2c5fab34-e8ee-8009-be83-fe483af64196" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20147.png"><img style="width:762.9765625px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20147.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8070-b4ba-d16b58866a34" class=""><span style="border-bottom:0.05em solid">Sample Test Results</span></p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80e7-ab33-d9baa16e6d7a" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8019-b6e4-e338f3b049b4" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-803b-9e59-dc0b6ebf7788" class="">Epoch 1 </p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8045-a0b6-f55831a62b5e" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80d4-b171-cc1b4c7edfe1" class="">Epoch 5</p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8045-b3e5-c2f5d1e3695f" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8085-b7a4-d63ead8dc228" class="">Epoch 10 </p></div></div></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8075-a998-d216e36a376d" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8035-a88d-d682c6896c70" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80fd-af0b-dfc50a0934e4" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20148.png"><img style="width:384px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20148.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80e2-bba6-ea400b5634e0" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80ef-a457-e1e2535b6728" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-805b-adf1-fbd4637c0a79" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20149.png"><img style="width:384px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20149.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8065-90db-de07c5c15097" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80dd-8f19-d2168f6f95cc" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20150.png"><img style="width:384px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20150.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8021-bf48-e16b7c6c69dc" class=""><strong>2.4 Adding Class-Conditioning to UNet</strong></p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8065-a265-cac9d7542d2a" class="">With time-conditioning in the flow matching UNet, the model learns how to denoise an image over time, but it does not know which digit it is supposed to generate. I add class-conditioning to guide the model towards producing a specific digit. Instead of just giving the model t, I provide a one-hot vector c that represents the digit class, and I feed it into the model through the fully connected blocks and add 2 new FCBlocks for class conditioning. I apply classifier-free guidance by dropping class conditioning 10% of the time since we also want the UNet to work without it being conditioned on the class.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80f3-9133-e84139931c1c" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-806b-bf3e-c05df7f20f7c" class=""><strong>2.5 Training Class-Conditioned UNet </strong></p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80d6-b6c9-f7abdb374ebc" class="">I used the following hyperparameters for training: </p></div><div style="display:contents" dir="auto"><ul id="2ccfab34-e8ee-805a-984c-f8bb8c76a675" class="bulleted-list"><li style="list-style-type:disc">Number of Epochs: 10</li></ul></div><div style="display:contents" dir="auto"><ul id="2ccfab34-e8ee-8082-83df-fad7eb747ec2" class="bulleted-list"><li style="list-style-type:disc">Batch Size: 64</li></ul></div><div style="display:contents" dir="auto"><ul id="2ccfab34-e8ee-8068-af8b-cfba42c6f4a6" class="bulleted-list"><li style="list-style-type:disc">Learning Rate: 5e-3</li></ul></div><div style="display:contents" dir="auto"><ul id="2ccfab34-e8ee-80fb-aac1-d0a446947292" class="bulleted-list"><li style="list-style-type:disc">Hidden Dimensions: 64</li></ul></div><div style="display:contents" dir="auto"><ul id="2ccfab34-e8ee-8031-8fd8-e5d50563bd0e" class="bulleted-list"><li style="list-style-type:disc">Num  Timesteps: 300</li></ul></div><div style="display:contents" dir="auto"><ul id="2ccfab34-e8ee-8025-a051-eebc2c09993d" class="bulleted-list"><li style="list-style-type:disc">Optimizer: Adam w/ ExponentialLR scheduler</li></ul></div><div style="display:contents" dir="auto"><ul id="2ccfab34-e8ee-8015-ab5b-dee2c38e4c40" class="bulleted-list"><li style="list-style-type:disc">p_uncond: 0.1</li></ul></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-80b6-b902-e756cde93e2d" class="">
</p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8096-adf9-d4c74a1a8b79" class="">Epoch 1 </p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8093-9ab6-cb486de26769" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8067-a341-c0697afc2d1e" style="width:50%" class="column"><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80bf-b62d-f11e48e64435" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20151.png"><img style="width:480px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20151.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-8028-85e4-c26afd3ebba9" style="width:50%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8025-a08a-d63215196678" class="">Epoch 5 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80ee-843b-ec6424f8e25d" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20152.png"><img style="width:528px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20152.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80d0-9e38-d5b27ee5d16f" class="">Epoch 10 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-8021-8b45-cecbf87d264c" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20153.png"><img style="width:432px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20153.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-809d-abcb-c42cac950d93" class=""><strong>2.6 Sampling from the UNet</strong></p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8093-8477-f9c438452959" class=""><span style="border-bottom:0.05em solid">Class-Conditional Generated Samples</span></p></div><div style="display:contents" dir="auto"><ol type="1" id="2c3fab34-e8ee-801a-abdf-d639506e58e7" class="numbered-list" start="1"><li>Sampling results from the class-conditioned UNet for 1, 5, and 10 epochs, with 4 instances of each digit from 0-9 (with learning rate scheduler)</li></ol></div><div style="display:contents" dir="auto"><div id="2c3fab34-e8ee-80f0-a876-eff7fabe5767" class="column-list"><div style="display:contents" dir="auto"><div id="2c3fab34-e8ee-80da-856d-d255d9144f69" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80d6-8f7a-de963ef07698" class="">Epoch 1</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80c0-b30a-c9eeec867053" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20154.png"><img style="width:288px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20154.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c3fab34-e8ee-80e0-8038-cf5d914536cb" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80de-9433-e141038f7791" class="">Epoch 5</p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80d9-83da-c21a9bf48dd8" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20155.png"><img style="width:288px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20155.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c3fab34-e8ee-80a3-8415-da72843b07b8" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-8003-9860-fdebcc7923b4" class="">Epoch 10 </p></div><div style="display:contents" dir="ltr"><figure id="2c3fab34-e8ee-80f1-ae47-ed8ed456c90d" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20156.png"><img style="width:288px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20156.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><ol type="1" id="2c3fab34-e8ee-80bd-aaba-ec3987d95295" class="numbered-list" start="2"><li><mark class="highlight-purple_background"><span style="border-bottom:0.05em solid">Removing the learning rate scheduler</span></mark></li></ol></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80c8-aa62-dd1b2ba3f68d" class="">The role of the scheduler was to decrease the learning rate epoch over epoch, which helps bring the model to convergence. I removed the ExponentialLR scheduler stepped once per epoch and instead trained with a fixed, albeit lower, learning rate. I noticed that directly using the original base learning rate 1e-2 caused the loss to plateau and the samples looked noisier, so I lowered the learning rate to 5e-3, then 1e-3, while keeping the same number of epochs. I then tried increasing the number of epochs I train for from 10 to 20 epochs to give the model enough time to converge.</p></div><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-8038-93f5-cd1aa0e4e354" class=""><span style="border-bottom:0.05em solid">a. Training Loss Curves without ExponentialLR scheduler</span></p></div><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-803a-bd20-c04742fa5cf9" class="">I achieved similar performance without the exponential learning rate scheduler with a fixed lower learning rate:</p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80c0-8479-f3a4276722be" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-802f-9708-edbdd1fce6aa" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2c3fab34-e8ee-80cb-9a63-cb1e8e3ca55d" class="">Epoch 1 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-8026-ab7b-de491d099487" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20157.png"><img style="width:480px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20157.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-805a-9f00-e3aa2745270a" style="width:33.333333333333336%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-803e-aad4-e7a35c5e31b2" class="">Epoch 5 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80a1-8bf0-fc9700f7293d" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20158.png"><img style="width:480px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20158.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-802a-848c-c74f0fd89c28" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="auto"><p id="2c5fab34-e8ee-80a7-ac4d-f075033cc379" class="">Epoch 10 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80e8-bd49-cabf8838094f" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20159.png"><img style="width:528px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20159.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-80f8-815c-fa2f8ae84cf4" class=""><span style="border-bottom:0.05em solid">b. Generated Samples without ExponentialLR scheduler</span></p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8010-98a7-ed98d978c07d" class="">I found that removing the learning rate scheduler does not decrease the quality of images that were generated noticeably.</p></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-801f-b4d4-d73d65cd9fb7" class="column-list"><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80ad-aa52-eed82bc6b59b" style="width:33.33333333333333%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-809a-ae09-f74e8d88a194" class="">Epoch 1 </p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-801c-a61a-fc024b1c2c50" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20160.png"><img style="width:288px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20160.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8087-b641-ffad26c50977" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80f2-b4a3-c59faf67b686" style="width:29.166666666666664%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8066-bc80-ff2a038139cd" class="">Epoch 5</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80d6-8911-ccca7e395f97" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20161.png"><img style="width:288px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20161.png"/></a></figure></div></div></div><div style="display:contents" dir="auto"><div id="2c4fab34-e8ee-80bf-8ca3-e5ebbfa77217" style="width:37.5%" class="column"><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-8078-a548-c7e447cd4e8a" class="">Epoch 10</p></div><div style="display:contents" dir="ltr"><figure id="2c4fab34-e8ee-80c5-a44d-ca8654cd87a9" class="image"><a href="project%205%20-%20fun%20with%20diffusion%20models/image%20162.png"><img style="width:288px" src="project%205%20-%20fun%20with%20diffusion%20models/image%20162.png"/></a></figure></div></div></div></div></div><div style="display:contents" dir="auto"><p id="2c4fab34-e8ee-802a-b473-cc222a734434" class=""><mark class="highlight-red_background">Conclusion</mark></p></div><div style="display:contents" dir="auto"><p id="2ccfab34-e8ee-8092-a5f6-dbf275700773" class="">I thoroughly enjoyed learning to implement a complete UNet with encoder-decoder structure and skip connections. I trained it and explored its out-of-distribution behavior with MNIST, implemented flow matching and extended to time and class conditioning, implemented CFG (this time for MNIST), and compared training without the exponential learning rate scheduler. </p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>